<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Metropolis Bimodal</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/mpi.css">
		<link rel="stylesheet" href="./sim/montecarlo.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!-- Monte Carlo -->
		<script src="./sim/metropolis_single.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>
      function fun_y(x) {return Math.exp(x);  }
      function fun_P(x) {return 0.01*Math.exp(-(Math.pow((x-0.5)/0.1,4)/4-5*Math.pow((x-0.5)/0.1,2)/2));}
    </script>
	</head>

<!--
  * Motivation NASA
-->
	<body >
		<div class="reveal">
			<div class="slides">
<!--
  importance sampling Metropolis
-->
      <section style="min-height:1050px">
        <h3>Example: Bimodal distribution with Metropolis sampling</h3>

        <div style="position:absolute; top:13%; left: 1%; width:98%; text-align:left">
          Assumptions:<br>
          The amount of required fule grows exponentially with time $y=\exp(x)$.<br>
          Landing time during training was bimodal $P(x) \propto \exp(-(x-x_0)^4-5(x-x_0)^2)$.
        </div>

        <span>
          <body onload="metropolis_sampling('canvas',fun_y, fun_P,0,1,0,5)" >
          <canvas id='canvas' style="position:absolute; top:40%; left:2%; height:55%; width:50%;"></canvas>
          </body>
          <input id="start" type="button" value="start" style="position:absolute; top:32%; left:5%;  height:5%; width:10%;"/>
          <input id="stop"  type="button" value="stop"  style="position:absolute; top:32%; left:15%; height:5%; width:10%;" />
        </span>

        <div style="position:absolute; top:35%; left:55%; width:45%; text-align:left">
          Quantity of interest:<br> $\mathbb{E}(y)=\int_0^1 y P(x) dx$<br>
          $\hspace{2em}\approx \frac{1}{N}\sum_i x_i$ with $x_i\sim P(x)$
          <pre>
          <code data-trim data-noescape>
          while(i &lt; N): 
            dx = -0.1+0.2*rand01()
            P_old = P(x)
            x += dx
            P_new = P(x)
            p_accept = P_new/P_old
            if p_accept &lt; 1 :
              if rand01() &gt; p_accept : 
                x-=dx;                        //reject
            y = exp(x)
            <mark>obs_y += y</mark>
            N+=1
            i+=1
          obs_y /= N;
          </code>
          </pre>
        </div>
      </section>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>
		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
			  margin: 0.01,
			  width:  1920,
      	height: 1080,
			  center: false,
			  viewDistance: 3,
			  fragmentInURL: true,
			  slideNumber:true,
			  history:true,
        transition:"fade",
        transitionSpeed:"fast",

	      math: {
	      	//mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
	      	mathjax: '/home/johannes/local_build/MathJax/MathJax.js',
	      	config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
	      },
				dependencies: [
				  // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
		      { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
		      // Interpret Markdown in <section> elements
		      { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
		      { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
		      // Syntax highlight for <code> elements
		      { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
		      // Zoom in and out with Alt+click
		      { src: 'plugin/zoom-js/zoom.js', async: true },
		      // Speaker notes
		      { src: 'plugin/notes/notes.js', async: true },
		      // MathJax
		      { src: 'plugin/math/math.js', async: true },
				]
			});
		</script>
		
	</body>
</html>
