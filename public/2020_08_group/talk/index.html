<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Heterogeneous spreading rates</title>

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/mpi.css">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement( 'link' );
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>
</head>

<body>
<div class="reveal">
    <div class="slides">
<!-- ############################################################################### -->
    <section>
      <div style="width:100%; min-height:1000px; max-height:1000px;">
        <div style="position:absolute; top:4%; left:5%; width:90%">
            <h2>Rare events in SIR dynamics<br> with heterogenous spreading rates 
              </h2>
        </div>
    
        <div style="position:absolute; top:20%; left:5%; width:90%">
            <b>Johannes Zierenberg</b>
    
        </div>
    
    
        <div style="position:absolute; bottom:3%; left:5%; width:90%">
          <img src="logos/bccn.gif" height=300 style="border:0; box-shadow:none; background:none; margin-left:20px" align="center">
          <img src="logos/Max-Planck-Gesellschaft.svg" height=300 style="border:0; box-shadow:none; background:none;margin-right:50px" align=center >
          <img src="logos/JHS_Logo_sRGB_violett.jpg" height=300 style="border:0; box-shadow:none; background:none;margin-right:50px" align=center >
        </div>
        <!--
        <div style="position:absolute; bottom:3%; width:100%">
          <img src="logos/bccn.gif" height=200 style="border:0; box-shadow:none; background:none; margin-left:20px" align="left">
          <img src="logos/Max-Planck-Gesellschaft.svg" height=200 style="border:0; box-shadow:none; background:none;margin-right:50px" align=center >
          <img src="logos/JHS_Logo_sRGB_violett.jpg" height=200 style="border:0; box-shadow:none; background:none;margin-right:50px" align=right >
        </div>
        <div style="position:absolute; bottom:2%; right:2%; width:15%; text-align:center">
        <img src="./logos/Max-Planck-Gesellschaft.svg" width= 80% style="border:0; box-shadow:none; background:none;" align=center >
        <img src="./logos/bccn.gif"                    width=100% style="border:0; box-shadow:none; background:none;" align=center>
        <img src="./logos/JHS_Logo_sRGB_violett.jpg"   width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </div>
        -->
      </div>
          
    </section>
<!-- ############################################################################### -->

<!-- ############################################################################### -->
    <section style="min-height:1050px">
        <h3>Mathematical modelling of epidemic outbreaks</h3>
        <span class="fragment fade-out" data-fragment-index="10">
            <img src="./sources/covid/germany.png" width=100% style="position:absolute; top:08%; left:32%; width:36%; border:0; box-shadow:none; background:none;" align=center >
        </span>
        <span class="fragment fade-out" data-fragment-index="10">
        <span class="fragment fade-in" data-fragment-index="1">
            <img id="person01" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:28%; left:55%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person02" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:30%; left:40%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person03" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:40%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person04" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:50%; left:59%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person05" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:30%; left:42%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person06" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:40%; left:61%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person07" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:50%; left:40%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person08" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:70%; left:51%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person09" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:50%; left:55%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person10" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:60%; left:44%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person11" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:80%; left:45%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person12" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:80%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        </span>
        <span class="fragment fade-in" data-fragment-index="2">
            <img id="person04" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:50%; left:59%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        </span>
        <span class="fragment fade-in" data-fragment-index="3">
            <img id="person03" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:40%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person07" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:50%; left:40%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        </span>
        <span class="fragment fade-in" data-fragment-index="4">
            <img id="person04" src="./sources/covid/person_green.png" width=100% style="position:absolute; top:50%; left:59%; width:2%; border:0; box-shadow:none; background:none;" align=center >

            <img id="person01" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:28%; left:55%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person12" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:80%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        </span>
        </span>
        <span class="fragment fade-in" data-fragment-index="10">
            <img id="person05" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person06" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:27%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person02" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:29%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person08" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person09" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:27%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person10" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:29%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person11" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:34%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person07" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person12" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:52%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person01" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:54%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person03" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:27%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
            <img id="person04" src="./sources/covid/person_green.png" width=100% style="position:absolute; top:20%; left:75%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        </span>
        <span class="fragment fade-in" data-fragment-index="12">
            <div style="position:absolute; left:20%; top:10%; width:15%; height:5%; text-align:center; padding-top:22%; border:solid">
                <b>S</b>usceptible
            </div>
        </span>
        <span class="fragment fade-in" data-fragment-index="13">
            <div style="position:absolute; left:45%; top:10%; width:15%; height:5%; text-align:center; padding-top:22%; border:solid">
                <b>I</b>nfected
            </div>
        </span>
        <span class="fragment fade-in" data-fragment-index="14">
            <div style="position:absolute; left:70%; top:10%; width:15%; height:5%; text-align:center; padding-top:22%; border:solid">
                <b>R</b>ecovered
            </div>
        </span>
        <span class="fragment fade-in" data-fragment-index="15">
            <!-- include the rates from left to right -->
            <svg viewBox="0 0 350 100" style="position:absolute; top:5%; left:05%; width:90%;">
              <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                refX="0" refY="3.5" orient="auto">
                  <polygon points="0 0, 10 3.5, 0 7" />
                </marker>
              </defs>
              <line x1="110" y1="50" x2="160" y2="50" stroke="#000" 
              stroke-width="1" marker-end="url(#arrowhead)" />
              <line x1="207" y1="50" x2="258" y2="50" stroke="#000" 
              stroke-width="1" marker-end="url(#arrowhead)" />
            </svg>
            <p  style="position:absolute; top:21%; left:35%; width:10%;"> $\lambda$ </p>
            <p  style="position:absolute; top:27%; left:35%; width:10%;"> spreading rate</p>
            <p  style="position:absolute; top:21%; left:60%; width:10%;"> $\mu$ </p>
            <p  style="position:absolute; top:27%; left:60%; width:10%;"> recovery rate</p>
        </span>
        <div class="fragment fade-in" data-fragment-index="20" style="position:absolute; left:5%; top:56%; width:90%; text-align:left;">
            The mean-field evolution of the outbreak can be described by the differential equations
            $$
                \frac{dS}{dt} = -\lambda\frac{S}{N} I\phantom{+\mu Itt}\\
                \frac{dI}{dt} = \left(\lambda\frac{S}{N} -\mu \right)I\\
            $$
        </div>
        <div class="fragment fade-in" data-fragment-index="21" style="position:absolute; left:5%; top:88%; width:90%; text-align:left;">
            For $S\approx N$ the dynamics is controlled by the effective growth rate <span style="border:solid">$\lambda^\ast=\lambda-\mu$<span>
        </div>

      <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
        <small>
            <br>Kermack et al., Proc. R. Soc. Lond. (1927).
            <br>Dehning et al. Science (2020).
        </small>
      </div>
    </section>


<!-- ############################################################################### -->
    <section style="min-height:1050px">
        <h3>Are we all the same?</h3>

        <span class="fragment fade-out" data-fragment-index="10" >
            <span class="fragment fade-in" data-fragment-index="1"  style="position:absolute; top:10%; left:20%; width:60%; text-align:left">
                <img src="./sources/covid/2005_lloyed_1.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
            </span>
            <span class="fragment fade-in" data-fragment-index="2"  style="position:absolute; top:50%; left:2%; width:96%; text-align:left">
                <img src="./sources/covid/2005_lloyed_2.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
            </span>
        </span>

        <span class="fragment fade-in" data-fragment-index="10"  style="position:absolute; top:10%; left:0%; width:50%; text-align:left">
            <img src="./sources/covid/2020_bitthin.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </span>
        <span class="fragment fade-in" data-fragment-index="11"  style="position:absolute; top:10%; left:50%; width:45%; text-align:left">
            <img src="./sources/covid/2020_neipel.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
            Heterogeneous susceptibility factor<br> (Gamma distributed)
        </span>
            
        
        <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
          <small>
              <br> LLoyed-Smith et al., Nature (2005).
              <br> Bettihn et al., medRxiv (2020).
              <br> Neipel et al., arXiv (2020).
          </small>
        </div>
    </section>

<!-- ############################################################################### -->
    <section style="min-height:1050px">
        <h3>Effect of heterogeneous spreading rates</h3>
        <div class="fragment fade-in" data-fragment-index="1" style="position:absolute; top:12%; left:5%; width:80%; text-align:left">
            We stay in the well-mixed scenario but now each infected has
            $\lambda_i\sim P(\lambda)$, i.e., 
            $$
            \text{random}\, S \to I \quad\text{with rate}\quad \sum_{i=0}^{I}\lambda_i \\
            \text{random}\, I \to R \quad\text{with rate}\quad \mu I\ \\
            $$
        </div>
        <div class="fragment fade-in" data-fragment-index="1" style="position:absolute; top:42%; left:5%; width:80%; text-align:left">
            Naively, we could write
            $$
            \frac{dI}{dt} = -\mu I +  \sum_{i=1}^I \lambda_i \frac{S}{N} = -\mu I + \bar{\lambda}I\frac{S}{N}
            $$
        </div>

        <div class="fragment fade-in" data-fragment-index="2" style="position:absolute; top:68%; left:5%; width:80%; text-align:left">
            Of course, this is not correct because $I$ is a discrete variable.<br>
            Instead, we now consider the stochastic evolution of $I$ by the master equation
            $$
            \frac{dP_I(t)}{dt} = \sum_{i=0}^{I-1}\lambda_i P_{I-1}(t) + \mu(I+t)P_{I+1}(t) - \left(\sum_{i=0}^I\lambda_i + \mu\right)P_I(t)
            $$
        </div>

    </section>


<!-- ############################################################################### -->
    <section style="min-height:1050px">
        <h3>Kinetic Monte Carlo algorithm</h3>
        <div class="fragment fade-in" data-fragment-index="1" style="position:absolute; top:12%; left:5%; width:80%; text-align:left">
            Our goal is to evaluate the Master equation
            $$
            \frac{dP_I(t)}{dt} = \sum_{i=0}^{I-1}\lambda_i P_{I-1}(t) + \mu(I+t)P_{I+1}(t) - \left(\sum_{i=0}^I\lambda_i + \mu\right)P_I(t)
            $$
        </div>

        <div class="fragment fade-in" data-fragment-index="2" style="position:absolute; top:45%; left:5%; width:80%; text-align:left">
            We achieve this by generating stochastic trajectories from a given
            initial condition $\{S_0,I_0,R_0\}$ and transition rates $r_{S\to
            I}$ and  $r_{I\to R}$ by
            <br><br>
            <ol> 
                <li>draw exponentially distributed time step $\Delta t \sim \text{Exponential}(r_{S\to I} + r_{I\to R})$</li>
                <li>draw random update type proportional to the transition rates</li>
                <ol type="a">
                    <li> if $S\to I$ draw new random $\lambda_i\sim P(\lambda_i)$ and add to list</li>
                    <li> if $I\to R$ select random $\lambda_i$ from list and remove</li>
                </ol>
                <li>go back to 1.</li>
            </ol>
        </div>

        
    </section>

<!-- ############################################################################### -->
    <section style="min-height:1050px">
        <h3>Dependence on dispersion parameter $k$</h3>
        <div style="position:absolute; top:12%; left:25%; width:50%; text-align:left">
            $$
            \lambda_i \sim \Gamma\left(k, \lambda/k\right) \qquad\text{with}\qquad \lambda=\mu=1/8
            $$
        </div>
            <span class="fragment fade-in-then-out" data-fragment-index="1"  style="position:absolute; top:25%; left:25%; width:50%; text-align:left">
                <img src="./sources/covid/2005_lloyed_1.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
            </span>
        <div class="fragment fade-in" data-fragment-index="10" style="position:absolute; top:25%; left:2%; width:48%; text-align:left">
                <img src="./sources/covid/hetero/fig_probability_distribution_t14_compare_k.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </div>
        <div class="fragment fade-in" data-fragment-index="11" style="position:absolute; top:25%; left:52%; width:48%; text-align:left">
                <img src="./sources/covid/hetero/fig_time_evolution_expectation_value_I01.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </div>
    </section>

    <section style="min-height:1050px">
        <h3>Dependence on initial condition</h3>
        <span class="fragment fade-out" data-fragment-index="10">  
            <div class="fragment fade-in" data-fragment-index="1" style="position:absolute; top:12%; left:5%; width:80%; text-align:left">
                We are still well-mixed! So we can approximate multiple initial infected as independent processes. 
            </div>
            <div class="fragment fade-in" data-fragment-index="2" style="position:absolute; top:23%; left:5%; width:80%; text-align:left">
                Then, $I_t = \sum_{j=1}^{I_0} I_t^j$ is a sum of random variables, we have evaluated so far $P^1(I_t)$,  and we are interested in $P(I_t|I_0)$. 
            </div>
            <div class="fragment fade-in" data-fragment-index="3" style="position:absolute; top:37%; left:5%; width:80%; text-align:left">
                It turns out that the distribution of a sum of iid. random
                variables is given by an n-fold convolution $P(I_t|I_0) = P^1\ast
                ....\ast P^1$, which is to be solved iteratively
                $$
                    P(I_t|I_0) = \sum_{i=0}^{I_0} P(i|I_0-1) P^1(I_t-i).
                $$
            </div>
            <div class="fragment fade-in" data-fragment-index="3" style="position:absolute; top:70%; left:5%; width:80%; text-align:left">
                Instead, however, we can solve the n-fold convolution conveniently in Fourier space
                $$
                    P(I_t|I_0) = \mathcal{F}^{-1}\left\{\mathcal{F}\left\{P^1\right\}^{I_0}\right\}. 
                $$
            </div>
        </span>
        <div class="fragment fade-in" data-fragment-index="10" style="position:absolute; top:12%; left:5%; width:80%; text-align:left">
             Assuming we can neglect interactions (also from a vanishing $S$
             pool), we can thus approximate any initial condition once we have $P^1(I_t) = P(I_t|I_0=1)$ via
             $$
                 P(I_t|I_0) = \mathcal{F}^{-1}\left\{\mathcal{F}\left\{P^1\right\}^{I_0}\right\}. 
             $$
        </div>
        <div class="fragment fade-in" data-fragment-index="11" style="position:absolute; top:35%; left:2%; width:48%; text-align:left">
                <img src="./sources/covid/hetero/fig_probability_distribution_approximation_homogeneous.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </div>
        <div class="fragment fade-in" data-fragment-index="12" style="position:absolute; top:35%; left:52%; width:48%; text-align:left">
                <img src="./sources/covid/hetero/fig_probability_distribution_approximation.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </div>
    </section>

    <section style="min-height:1050px">
        <h3>Probability of extreme events</h3>
        <span class="fragment fade-in" data-fragment-index="1"  style="position:absolute; top:12%; left:2%; width:96%; text-align:left">
            <img src="./sources/covid/2005_lloyed_2.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </span>
        <div class="fragment fade-in" data-fragment-index="10" style="position:absolute; top:50%; left:10%; width:35%; text-align:left">
                <img src="./sources/covid/hetero/fig_probability_extreme_events_I01_single.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </div>
        <div class="fragment fade-in" data-fragment-index="11" style="position:absolute; top:50%; left:55%; width:35%; text-align:left">
                <img src="./sources/covid/hetero/fig_probability_extreme_events_t14.png" width=100% style="border:0; box-shadow:none; background:none;" align=center >
        </div>
    </section>
    
<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>
<script>
	// More info about config & dependencies:
	// - https://github.com/hakimel/reveal.js#configuration
	// - https://github.com/hakimel/reveal.js#dependencies
	Reveal.initialize({
	  margin: 0.01,
	  width:  1920,
height: 1080,
		  center: false,
		  viewDistance: 3,
		  fragmentInURL: true,
		  slideNumber:true,
		  history:true,
    transition:"none",
    //transition:"convex",
    //transitionSpeed:"normal",
    transitionSpeed:"fast",

      math: {
      	mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
      	//mathjax: '/home/johannes/local_build/MathJax/MathJax.js',
      	config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
      },
			dependencies: [
			  // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
	      { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
	      // Interpret Markdown in <section> elements
	      { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
	      { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
	      // Syntax highlight for <code> elements
	      { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
	      // Zoom in and out with Alt+click
	      { src: 'plugin/zoom-js/zoom.js', async: true },
	      // Speaker notes
	      { src: 'plugin/notes/notes.js', async: true },
	      // MathJax
	      { src: 'plugin/math/math.js', async: true }
			]
		});
</script>
</body>
</html>
